package models

var (
	db *sql.DB
	{{range .Entities}}
	{{.Name}}Repo {{.Name}}Repository
	{{- end}}
)

const (
	OperationMerge  byte = 'M'
	OperationInsert byte = 'I'
	OperationUpdate byte = 'U'
)

// Init is responsible to initialize all repositories
func Init(database *sql.DB) {
	db = database
	{{range .Entities}}
	{{.Name}}Repo = {{.Name}}Repository{db: database}
	{{- end}}
}

// StartTransaction initiates a database transaction
func StartTransaction() (*sql.Tx, error) {
	return db.Begin()
}

//ListFilter represents a filter to apply during listing (crud)
type ListFilter struct {
	Field     string
	Operation string
	Value     interface{}
}

{{range .Entities -}}
// {{.Name}}Repository encapsulates operations that may be performed on the entity {{.Name}}
type {{.Name}}Repository struct {
	db *sql.DB
}
{{end}}